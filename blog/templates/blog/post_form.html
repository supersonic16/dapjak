{% extends "base.html" %}

{% block title %}
  New Story - DapJak
{% endblock %}

{% load crispy_forms_tags %}
{% load static from static %}



{% block body %}
<body>
<div class="container">
  <div class="row">
    <div class="col-lg-1"></div>
    <div class="col-lg-10 col-md-10 col-sm-12 bg-white ml-n5">
  <form class="text-center border border-light p-5 pr-0 mr-n5 mt-n3" enctype= 'multipart/form-data' method="post">
    {% csrf_token %}
<!-- Title -->
  {{ form.non_field_errors }}
    <div class="fieldWrapper pr-n5 mr-n5">
  {{ form.title.errors }}
    <label for="{{ form.title.id_title }}"></label>
  {{ form.title }}
    </div>
<!-- Sub Title -->
  {{ form.non_field_errors }}
    <div class="fieldWrapper pr-n5 mr-n5">
  {{ form.sub_title.errors }}
    <label for="{{ form.sub_title.id_sub_title }}"></label>
  {{ form.sub_title }}
    </div>
<!-- cover_image -->

{{ form.non_field_errors }}
  <div class="fieldWrapper pr-n5 mr-n5">
{{ form.cover_image.errors }}
  <label for="{{ form.cover_image.id_cover_image }}" ></label>
{{ form.cover_image }}
  </div>

<!-- credit -->
  {{ form.non_field_errors }}
    <div class="fieldWrapper pr-n5 mr-n5">
  {{ form.credit.errors }}
    <label for="{{ form.credit.id_credit }}"></label>
  {{ form.credit }}
    </div>
<!-- Content -->

  {{ form.non_field_errors }}
    <div class="fieldWrapper pr-n5 mr-n5" id="div_content">
  {{ form.content.errors }}
    <label for="{{ form.content.id_content }}"></label>
  {{ form.content }}
    </div>

    <!-- Classification -->
  {{ form.non_field_errors }}
    <div class="fieldWrapper pr-n5 mr-n5 my-4">
  {{ form.classification.errors }}
    <label for="{{ form.classification.id_classification }}" style="float: left">Classification</label>
  {{ form.classification }}
    </div>

    <button class="btn btn-primary btn-block" type="submit" id="publishbtn" style="width: auto">Publish</button>
  </form>
  </div>
  </div>
</div>
{% block javascript %}
<script type="text/javascript">
  $('#id_title').focus();
  tinymce.init({
      selector: '#id_content',
  
      plugins: [
      'advlist autolink link image lists charmap print preview hr anchor pagebreak spellchecker',
      'searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking',
      'table emoticons template paste help quickbars imagetools'
    ],
      toolbar: 'insertfile undo redo | styleselect | bold italic blockquote | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link preview media fullpage | forecolor backcolor emoticons',

      menubar: false,
      statusbar: false,
      image_caption: true,
      quickbars_insert_toolbar: false,
      content_css: 'http://localhost:8000/static/blog/content.css',
    

    //   images_upload_handler: function (blobInfo, success, failure) {
    //   var xhr, formData;
    //   xhr = new XMLHttpRequest();
    //   xhr.withCredentials = false;
    //   xhr.open('POST', 'http://localhost:8000/static/blog/postAcceptor.php');
    //   xhr.onload = function () {
    //     var json;

    //     if (xhr.status != 200) {
    //       failure('HTTP Error: ' + xhr.status);
    //       return;
    //     }
    //     json = JSON.parse(xhr.responseText);

    //     if (!json || typeof json.location != 'string') {
    //       failure('Invalid JSON: ' + xhr.responseText);
    //       return;
    //     }
    //     success(json.location);
    //   };
    //   formData = new FormData();
    //   formData.append('file', blobInfo.blob(), blobInfo.filename());
    //   xhr.send(formData);
    // },






      
     setup: function (editor) {
      editor.on('change', editor.save);
        }

    });

  $(document).ready(function() {
    $("#cover_image-clear_id").addClass("form-check-input");
    // $("#publishbtn").click(function(){
    //   $('#id_content').tinymce().save();
    // })
  // $(window).keydown(function(event){
  //   if(event.keyCode == 13) {
  //     event.keyCode=9;
  //     return false;
  //   }
  // });
});

//   $(".custom-btn").click(function(){
//     if ($("a").hasClass("active")){
//         $('a').removeClass("active");
//         $(this).addClass("active");
//     }
//     else{
//         $(this).addClass("active");
//     }
//
//     $.ajax({
//         url:,
//         dataType:  'json',
//         data: {
//
//         },
//         success: function(){
//
//         }
//     })
// })


</script>
{% endblock %}

</body>
{% endblock %}
